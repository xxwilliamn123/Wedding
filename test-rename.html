<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test File Rename</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        input, button { margin: 5px; padding: 8px; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Test File Rename Functionality</h1>
    
    <div class="test-section">
        <h3>Test File Rename</h3>
        <p>Enter a Google Drive file ID to test renaming:</p>
        <input type="text" id="fileId" placeholder="Enter Google Drive File ID" style="width: 300px;">
        <input type="text" id="newName" placeholder="New file name" style="width: 200px;">
        <button onclick="testRename()">Test Rename</button>
        <div id="renameResult" class="result" style="display: none;"></div>
    </div>

    <script>
        async function testRename() {
            const fileId = document.getElementById('fileId').value;
            const newName = document.getElementById('newName').value;
            const resultDiv = document.getElementById('renameResult');
            
            if (!fileId || !newName) {
                alert('Please enter both file ID and new name');
                return;
            }
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = 'Testing rename...';
            
            try {
                const renameData = new URLSearchParams();
                renameData.append('action', 'rename');
                renameData.append('fileId', fileId);
                renameData.append('newName', newName);
                
                const response = await fetch('https://script.google.com/macros/s/AKfycbwYEwuNFzjtEXqyFbHKdTvCrUReTjascRlImmZ87Y2NGph9AZTXhrMQDdqkAkbiHq1z/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: renameData.toString()
                });
                
                const result = await response.json();
                
                if (result.success) {
                    resultDiv.innerHTML = `<strong>Success!</strong> File renamed to: ${newName}`;
                    resultDiv.style.backgroundColor = '#d4edda';
                    resultDiv.style.color = '#155724';
                } else {
                    resultDiv.innerHTML = `<strong>Error:</strong> ${result.message || 'Unknown error'}`;
                    resultDiv.style.backgroundColor = '#f8d7da';
                    resultDiv.style.color = '#721c24';
                }
            } catch (error) {
                resultDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
                resultDiv.style.backgroundColor = '#f8d7da';
                resultDiv.style.color = '#721c24';
            }
        }
    </script>
</body>
</html> 